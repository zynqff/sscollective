<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{% block title %}Сборник Стихов{% endblock %}</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --accent-color: #38bdf8;
            --text-color: #374151;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
        }

        pre.poem {
            white-space: pre-wrap;
            line-height: 1.6;
            font-family: inherit;
            font-size: 1rem;
            color: var(--text-color);
            margin: 0;
        }

        .modal {
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            visibility: hidden;
        }

        .modal.open {
            opacity: 1;
            visibility: visible;
        }

        .tab.active,
        .sort-btn.active {
            background-color: var(--accent-color);
            color: white;
        }

        /* --- СТИЛИ ДЛЯ ОТВЕТОВ НЕЙРОСЕТИ (Markdown) --- */
        .ai-response-content {
            line-height: 1.6;
        }
        .ai-response-content p {
            margin-bottom: 0.75rem !important;
        }
        .ai-response-content p:last-child {
            margin-bottom: 0 !important;
        }
        .ai-response-content strong {
            font-weight: 800 !important;
            color: #111827 !important;
        }
        .ai-response-content ul {
            list-style-type: disc !important;
            padding-left: 1.5rem !important;
            margin: 0.75rem 0 !important;
        }
        .ai-response-content ol {
            list-style-type: decimal !important;
            padding-left: 1.5rem !important;
            margin: 0.75rem 0 !important;
        }
        .ai-response-content li {
            margin-bottom: 0.25rem !important;
        }
        .ai-response-content code {
            background-color: #f3f4f6;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-size: 0.875em;
            font-family: monospace;
        }
    </style>
</head>
<body class="text-gray-800">
    <div id="notification-container" class="fixed top-4 right-4 z-[100] flex flex-col items-end pointer-events-none"></div>

    <div class="max-w-4xl mx-auto px-4 py-8">
    {% block header %}
        <header class="flex flex-col sm:flex-row justify-between items-center mb-10 gap-4">
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">
                <a href="/" class="hover:text-sky-500 transition-colors">Сборник Стихов</a>
            </h1>
            <nav class="flex items-center space-x-2 bg-white p-1 rounded-xl shadow-sm border border-gray-100">
                {% if current_user %}
                    <a href="/profile" class="px-4 py-2 text-sm font-semibold text-gray-600 hover:text-sky-500 transition-colors">Профиль</a>
                    {% if is_admin %}
                        <a href="/admin_panel" class="px-4 py-2 text-sm font-semibold text-gray-600 hover:text-red-500 transition-colors">Админ</a>
                    {% endif %}
                    <a href="/logout" class="px-4 py-2 text-sm font-semibold text-white bg-gray-400 hover:bg-gray-500 rounded-lg transition-colors">Выход</a>
                {% else %}
                    <a href="/login" class="px-4 py-2 text-sm font-semibold text-gray-600 hover:text-sky-500 transition-colors">Вход</a>
                    <a href="/register" class="px-4 py-2 text-sm font-semibold text-white bg-sky-500 hover:bg-sky-600 rounded-lg transition-colors">Регистрация</a>
                {% endif %}
            </nav>
        </header>
    {% endblock %}
    
    {% block content %}{% endblock %}
    
    {% block modals %}{% endblock %}
    
    {% block scripts %}
    <script>
        /**
         * Функция показа уведомлений (Toast)
         */
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `p-3 rounded-lg shadow-md text-sm mb-2 opacity-0 transition-opacity duration-300 pointer-events-auto`;

            if (type === 'success') {
                notification.classList.add('bg-green-500', 'text-white');
            } else if (type === 'error') {
                notification.classList.add('bg-red-500', 'text-white');
            } else {
                notification.classList.add('bg-blue-500', 'text-white');
            }
            notification.textContent = message;

            container.prepend(notification);

            setTimeout(() => {
                notification.classList.add('opacity-100');
            }, 10);

            setTimeout(() => {
                notification.classList.remove('opacity-100');
                notification.classList.add('opacity-0');
                notification.addEventListener('transitionend', () => notification.remove());
            }, 3000);
        }
    </script>
    {% endblock %}
    </div>
</body>
</html>
